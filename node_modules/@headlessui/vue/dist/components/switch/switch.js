import{computed as a,defineComponent as y,Fragment as H,h as b,inject as M,onMounted as B,provide as P,ref as v,watch as j}from"vue";import{useControllable as G}from'../../hooks/use-controllable.js';import{useId as V}from'../../hooks/use-id.js';import{useResolveButtonType as F}from'../../hooks/use-resolve-button-type.js';import{Features as I,Hidden as O}from'../../internal/hidden.js';import{Keys as S}from'../../keyboard.js';import{dom as A}from'../../utils/dom.js';import{attemptSubmit as $}from'../../utils/form.js';import{compact as N,omit as U,render as w}from'../../utils/render.js';import{Description as _,useDescriptions as q}from'../description/description.js';import{Label as z,useLabels as J}from'../label/label.js';let g=Symbol("GroupContext"),oe=y({name:"SwitchGroup",props:{as:{type:[Object,String],default:"template"}},setup(l,{slots:c,attrs:o}){let r=v(null),p=J({name:"SwitchLabel",props:{htmlFor:a(()=>{var t;return(t=r.value)==null?void 0:t.id}),onClick(t){r.value&&(t.currentTarget.tagName==="LABEL"&&t.preventDefault(),r.value.click(),r.value.focus({preventScroll:!0}))}}}),f=q({name:"SwitchDescription"});return P(g,{switchRef:r,labelledby:p,describedby:f}),()=>w({theirProps:l,ourProps:{},slot:{},slots:c,attrs:o,name:"SwitchGroup"})}}),ue=y({name:"Switch",emits:{"update:modelValue":l=>!0},props:{as:{type:[Object,String],default:"button"},modelValue:{type:Boolean,default:void 0},defaultChecked:{type:Boolean,optional:!0},form:{type:String,optional:!0},name:{type:String,optional:!0},value:{type:String,optional:!0},id:{type:String,default:null}},inheritAttrs:!1,setup(l,{emit:c,attrs:o,slots:r,expose:p}){var h;let f=(h=l.id)!=null?h:`headlessui-switch-${V()}`,n=M(g,null),[t,s]=G(a(()=>l.modelValue),e=>c("update:modelValue",e),a(()=>l.defaultChecked));function m(){s(!t.value)}let k=v(null),u=n===null?k:n.switchRef,C=F(a(()=>({as:l.as,type:o.type})),u);p({el:u,$el:u});function E(e){e.preventDefault(),m()}function L(e){e.key===S.Space?(e.preventDefault(),m()):e.key===S.Enter&&$(e.currentTarget)}function D(e){e.preventDefault()}let d=a(()=>{var e,i;return(i=(e=A(u))==null?void 0:e.closest)==null?void 0:i.call(e,"form")});return B(()=>{j([d],()=>{if(!d.value||l.defaultChecked===void 0)return;function e(){s(l.defaultChecked)}return d.value.addEventListener("reset",e),()=>{var i;(i=d.value)==null||i.removeEventListener("reset",e)}},{immediate:!0})}),()=>{let{name:e,value:i,form:R,...K}=l,x={checked:t.value},T={id:f,ref:u,role:"switch",type:C.value,tabIndex:0,"aria-checked":t.value,"aria-labelledby":n==null?void 0:n.labelledby.value,"aria-describedby":n==null?void 0:n.describedby.value,onClick:E,onKeyup:L,onKeypress:D};return b(H,[e!=null&&t.value!=null?b(O,N({features:I.Hidden,as:"input",type:"checkbox",hidden:!0,readOnly:!0,checked:t.value,form:R,name:e,value:i})):null,w({ourProps:T,theirProps:{...o,...U(K,["modelValue","defaultChecked"])},slot:x,attrs:o,slots:r,name:"Switch"})])}}}),ae=z,de=_;export{ue as Switch,de as SwitchDescription,oe as SwitchGroup,ae as SwitchLabel};
