import{G as x,ab as J,bt as ge,D as j,bu as oe,bv as xe,a as ue,bw as te,r as D,bc as W,bx as de,d as U,b3 as L,bp as Oe,aU as S,B as _,b4 as Se,b7 as ce,b8 as Ie,b9 as X,o as le,ay as G,aV as ye,aW as Re,aX as Ee,aY as Y,aZ as ne,F as Ce,aS as Q,bb as Z,ba as Te,ag as ve,ax as we,be as Me,aT as ze,a_ as $,bd as B,by as ae,bz as Pe}from"./BzSYuNgW.js";import{d as De,e as Fe}from"./fU-Uvyx9.js";function q(l,r,e){let o=e.initialDeps??[],t;return()=>{var a,i,n,v;let f;e.key&&((a=e.debug)!=null&&a.call(e))&&(f=Date.now());const p=l();if(!(p.length!==o.length||p.some((M,E)=>o[E]!==M)))return t;o=p;let R;if(e.key&&((i=e.debug)!=null&&i.call(e))&&(R=Date.now()),t=r(...p),e.key&&((n=e.debug)!=null&&n.call(e))){const M=Math.round((Date.now()-f)*100)/100,E=Math.round((Date.now()-R)*100)/100,F=E/16,A=(P,b)=>{for(P=String(P);P.length<b;)P=" "+P;return P};console.info(`%câ± ${A(E,5)} /${A(M,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*F,120))}deg 100% 31%);`,e==null?void 0:e.key)}return(v=e==null?void 0:e.onChange)==null||v.call(e,t),t}}function ee(l,r){if(l===void 0)throw new Error("Unexpected undefined");return l}const $e=(l,r)=>Math.abs(l-r)<1,Ae=(l,r)=>{let e;return function(...o){clearTimeout(e),e=setTimeout(()=>l.apply(this,o),r)}},Ve=l=>l,ke=l=>{const r=Math.max(l.startIndex-l.overscan,0),e=Math.min(l.endIndex+l.overscan,l.count-1),o=[];for(let t=r;t<=e;t++)o.push(t);return o},_e=(l,r)=>{const e=l.scrollElement;if(!e)return;const o=a=>{const{width:i,height:n}=a;r({width:Math.round(i),height:Math.round(n)})};if(o(e.getBoundingClientRect()),typeof ResizeObserver>"u")return()=>{};const t=new ResizeObserver(a=>{const i=a[0];if(i!=null&&i.borderBoxSize){const n=i.borderBoxSize[0];if(n){o({width:n.inlineSize,height:n.blockSize});return}}o(e.getBoundingClientRect())});return t.observe(e,{box:"border-box"}),()=>{t.unobserve(e)}},ie={passive:!0},Be=typeof window>"u"?!0:"onscrollend"in window,je=(l,r)=>{const e=l.scrollElement;if(!e)return;let o=0;const t=Be?()=>{}:Ae(()=>{r(o,!1)},l.options.isScrollingResetDelay),a=v=>()=>{o=e[l.options.horizontal?"scrollLeft":"scrollTop"],t(),r(o,v)},i=a(!0),n=a(!1);return n(),e.addEventListener("scroll",i,ie),e.addEventListener("scrollend",n,ie),()=>{e.removeEventListener("scroll",i),e.removeEventListener("scrollend",n)}},Ne=(l,r,e)=>{if(r!=null&&r.borderBoxSize){const o=r.borderBoxSize[0];if(o)return Math.round(o[e.options.horizontal?"inlineSize":"blockSize"])}return Math.round(l.getBoundingClientRect()[e.options.horizontal?"width":"height"])},Le=(l,{adjustments:r=0,behavior:e},o)=>{var t,a;const i=l+r;(a=(t=o.scrollElement)==null?void 0:t.scrollTo)==null||a.call(t,{[o.options.horizontal?"left":"top"]:i,behavior:e})};class Ue{constructor(r){this.unsubs=[],this.scrollElement=null,this.isScrolling=!1,this.scrollToIndexTimeoutId=null,this.measurementsCache=[],this.itemSizeCache=new Map,this.pendingMeasuredCacheIndexes=[],this.scrollDirection=null,this.scrollAdjustments=0,this.measureElementCache=new Map,this.observer=(()=>{let e=null;const o=()=>e||(typeof ResizeObserver<"u"?e=new ResizeObserver(t=>{t.forEach(a=>{this._measureElement(a.target,a)})}):null);return{disconnect:()=>{var t;return(t=o())==null?void 0:t.disconnect()},observe:t=>{var a;return(a=o())==null?void 0:a.observe(t,{box:"border-box"})},unobserve:t=>{var a;return(a=o())==null?void 0:a.unobserve(t)}}})(),this.range=null,this.setOptions=e=>{Object.entries(e).forEach(([o,t])=>{typeof t>"u"&&delete e[o]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:Ve,rangeExtractor:ke,onChange:()=>{},measureElement:Ne,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,...e}},this.notify=(e,o)=>{var t,a;const{startIndex:i,endIndex:n}=this.range??{startIndex:void 0,endIndex:void 0},v=this.calculateRange();(e||i!==(v==null?void 0:v.startIndex)||n!==(v==null?void 0:v.endIndex))&&((a=(t=this.options).onChange)==null||a.call(t,this,o))},this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(e=>e()),this.unsubs=[],this.scrollElement=null},this._didMount=()=>(this.measureElementCache.forEach(this.observer.observe),()=>{this.observer.disconnect(),this.cleanup()}),this._willUpdate=()=>{const e=this.options.getScrollElement();this.scrollElement!==e&&(this.cleanup(),this.scrollElement=e,this._scrollToOffset(this.scrollOffset,{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,o=>{this.scrollRect=o,this.notify(!1,!1)})),this.unsubs.push(this.options.observeElementOffset(this,(o,t)=>{this.scrollAdjustments=0,this.scrollDirection=t?this.scrollOffset<o?"forward":"backward":null,this.scrollOffset=o;const a=this.isScrolling;this.isScrolling=t,this.notify(a!==t,t)})))},this.getSize=()=>this.scrollRect[this.options.horizontal?"width":"height"],this.getMeasurementOptions=q(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey],(e,o,t,a)=>(this.pendingMeasuredCacheIndexes=[],{count:e,paddingStart:o,scrollMargin:t,getItemKey:a}),{key:!1}),this.getFurthestMeasurement=(e,o)=>{const t=new Map,a=new Map;for(let i=o-1;i>=0;i--){const n=e[i];if(t.has(n.lane))continue;const v=a.get(n.lane);if(v==null||n.end>v.end?a.set(n.lane,n):n.end<v.end&&t.set(n.lane,!0),t.size===this.options.lanes)break}return a.size===this.options.lanes?Array.from(a.values()).sort((i,n)=>i.end===n.end?i.index-n.index:i.end-n.end)[0]:void 0},this.getMeasurements=q(()=>[this.getMeasurementOptions(),this.itemSizeCache],({count:e,paddingStart:o,scrollMargin:t,getItemKey:a},i)=>{const n=this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[];const v=this.measurementsCache.slice(0,n);for(let f=n;f<e;f++){const p=a(f),h=this.options.lanes===1?v[f-1]:this.getFurthestMeasurement(v,f),R=h?h.end+this.options.gap:o+t,M=i.get(p),E=typeof M=="number"?M:this.options.estimateSize(f),F=R+E,A=h?h.lane:f%this.options.lanes;v[f]={index:f,start:R,size:E,end:F,key:p,lane:A}}return this.measurementsCache=v,v},{key:!1,debug:()=>this.options.debug}),this.calculateRange=q(()=>[this.getMeasurements(),this.getSize(),this.scrollOffset],(e,o,t)=>this.range=e.length>0&&o>0?Ke({measurements:e,outerSize:o,scrollOffset:t}):null,{key:!1,debug:()=>this.options.debug}),this.getIndexes=q(()=>[this.options.rangeExtractor,this.calculateRange(),this.options.overscan,this.options.count],(e,o,t,a)=>o===null?[]:e({startIndex:o.startIndex,endIndex:o.endIndex,overscan:t,count:a}),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=e=>{const o=this.options.indexAttribute,t=e.getAttribute(o);return t?parseInt(t,10):(console.warn(`Missing attribute name '${o}={index}' on measured element.`),-1)},this._measureElement=(e,o)=>{const t=this.measurementsCache[this.indexFromElement(e)];if(!t||!e.isConnected){this.measureElementCache.forEach((n,v)=>{n===e&&(this.observer.unobserve(e),this.measureElementCache.delete(v))});return}const a=this.measureElementCache.get(t.key);a!==e&&(a&&this.observer.unobserve(a),this.observer.observe(e),this.measureElementCache.set(t.key,e));const i=this.options.measureElement(e,o,this);this.resizeItem(t,i)},this.resizeItem=(e,o)=>{const t=this.itemSizeCache.get(e.key)??e.size,a=o-t;a!==0&&((this.shouldAdjustScrollPositionOnItemSizeChange!==void 0?this.shouldAdjustScrollPositionOnItemSizeChange(e,a,this):e.start<this.scrollOffset+this.scrollAdjustments)&&this._scrollToOffset(this.scrollOffset,{adjustments:this.scrollAdjustments+=a,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(e.index),this.itemSizeCache=new Map(this.itemSizeCache.set(e.key,o)),this.notify(!0,!1))},this.measureElement=e=>{e&&this._measureElement(e,void 0)},this.getVirtualItems=q(()=>[this.getIndexes(),this.getMeasurements()],(e,o)=>{const t=[];for(let a=0,i=e.length;a<i;a++){const n=e[a],v=o[n];t.push(v)}return t},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=e=>{const o=this.getMeasurements();return ee(o[fe(0,o.length-1,t=>ee(o[t]).start,e)])},this.getOffsetForAlignment=(e,o)=>{const t=this.getSize();o==="auto"&&(e<=this.scrollOffset?o="start":e>=this.scrollOffset+t?o="end":o="start"),o==="start"?e=e:o==="end"?e=e-t:o==="center"&&(e=e-t/2);const a=this.options.horizontal?"scrollWidth":"scrollHeight",n=(this.scrollElement?"document"in this.scrollElement?this.scrollElement.document.documentElement[a]:this.scrollElement[a]:0)-this.getSize();return Math.max(Math.min(n,e),0)},this.getOffsetForIndex=(e,o="auto")=>{e=Math.max(0,Math.min(e,this.options.count-1));const t=ee(this.getMeasurements()[e]);if(o==="auto")if(t.end>=this.scrollOffset+this.getSize()-this.options.scrollPaddingEnd)o="end";else if(t.start<=this.scrollOffset+this.options.scrollPaddingStart)o="start";else return[this.scrollOffset,o];const a=o==="end"?t.end+this.options.scrollPaddingEnd:t.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(a,o),o]},this.isDynamicMode=()=>this.measureElementCache.size>0,this.cancelScrollToIndex=()=>{this.scrollToIndexTimeoutId!==null&&(clearTimeout(this.scrollToIndexTimeoutId),this.scrollToIndexTimeoutId=null)},this.scrollToOffset=(e,{align:o="start",behavior:t}={})=>{this.cancelScrollToIndex(),t==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(e,o),{adjustments:void 0,behavior:t})},this.scrollToIndex=(e,{align:o="auto",behavior:t}={})=>{e=Math.max(0,Math.min(e,this.options.count-1)),this.cancelScrollToIndex(),t==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size.");const[a,i]=this.getOffsetForIndex(e,o);this._scrollToOffset(a,{adjustments:void 0,behavior:t}),t!=="smooth"&&this.isDynamicMode()&&(this.scrollToIndexTimeoutId=setTimeout(()=>{if(this.scrollToIndexTimeoutId=null,this.measureElementCache.has(this.options.getItemKey(e))){const[v]=this.getOffsetForIndex(e,i);$e(v,this.scrollOffset)||this.scrollToIndex(e,{align:i,behavior:t})}else this.scrollToIndex(e,{align:i,behavior:t})}))},this.scrollBy=(e,{behavior:o}={})=>{this.cancelScrollToIndex(),o==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.scrollOffset+e,{adjustments:void 0,behavior:o})},this.getTotalSize=()=>{var e;const o=this.getMeasurements();let t;return o.length===0?t=this.options.paddingStart:t=this.options.lanes===1?((e=o[o.length-1])==null?void 0:e.end)??0:Math.max(...o.slice(-this.options.lanes).map(a=>a.end)),t-this.options.scrollMargin+this.options.paddingEnd},this._scrollToOffset=(e,{adjustments:o,behavior:t})=>{this.options.scrollToFn(e,{behavior:t,adjustments:o},this)},this.measure=()=>{var e,o;this.itemSizeCache=new Map,(o=(e=this.options).onChange)==null||o.call(e,this,!1)},this.setOptions(r),this.scrollRect=this.options.initialRect,this.scrollOffset=typeof this.options.initialOffset=="function"?this.options.initialOffset():this.options.initialOffset,this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(e=>{this.itemSizeCache.set(e.key,e.size)}),this.notify(!1,!1)}}const fe=(l,r,e,o)=>{for(;l<=r;){const t=(l+r)/2|0,a=e(t);if(a<o)l=t+1;else if(a>o)r=t-1;else return t}return l>0?l-1:0};function Ke({measurements:l,outerSize:r,scrollOffset:e}){const o=l.length-1,a=fe(0,o,n=>l[n].start,e);let i=a;for(;i<o&&l[i].end<e+r;)i++;return{startIndex:a,endIndex:i}}function He(l){const r=new Ue(J(l)),e=ge(r),o=r._didMount();return j(()=>J(l).getScrollElement(),t=>{t&&r._willUpdate()},{immediate:!0}),j(()=>J(l),t=>{r.setOptions({...t,onChange:(a,i)=>{var n;oe(e),(n=t.onChange)==null||n.call(t,a,i)}}),r._willUpdate(),oe(e)},{immediate:!0}),xe(o),e}function qe(l){return He(x(()=>({observeElementRect:_e,observeElementOffset:je,scrollToFn:Le,...J(l)})))}function We(){let l=te();return ue(()=>l.dispose()),l}function Ye(){let l=We();return r=>{l.dispose(),l.nextFrame(r)}}function se(l){return[l.screenX,l.screenY]}function Je(){let l=D([-1,-1]);return{wasMoved(r){let e=se(r);return l.value[0]===e[0]&&l.value[1]===e[1]?!1:(l.value=e,!0)},update(r){l.value=se(r)}}}function Xe({container:l,accept:r,walk:e,enabled:o}){W(()=>{let t=l.value;if(!t||o!==void 0&&!o.value)return;let a=de(l);if(!a)return;let i=Object.assign(v=>r(v),{acceptNode:r}),n=a.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,i,!1);for(;n.nextNode();)e(n.currentNode)})}var pe=(l=>(l[l.Left=0]="Left",l[l.Right=2]="Right",l))(pe||{});function Ge(l){throw new Error("Unexpected object: "+l)}var z=(l=>(l[l.First=0]="First",l[l.Previous=1]="Previous",l[l.Next=2]="Next",l[l.Last=3]="Last",l[l.Specific=4]="Specific",l[l.Nothing=5]="Nothing",l))(z||{});function re(l,r){let e=r.resolveItems();if(e.length<=0)return null;let o=r.resolveActiveIndex(),t=o??-1;switch(l.focus){case 0:{for(let a=0;a<e.length;++a)if(!r.resolveDisabled(e[a],a,e))return a;return o}case 1:{t===-1&&(t=e.length);for(let a=t-1;a>=0;--a)if(!r.resolveDisabled(e[a],a,e))return a;return o}case 2:{for(let a=t+1;a<e.length;++a)if(!r.resolveDisabled(e[a],a,e))return a;return o}case 3:{for(let a=e.length-1;a>=0;--a)if(!r.resolveDisabled(e[a],a,e))return a;return o}case 4:{for(let a=0;a<e.length;++a)if(r.resolveId(e[a],a,e)===l.id)return a;return o}case 5:return null;default:Ge(l)}}var Ze={};function Qe(l,r){return l===r}var et=(l=>(l[l.Open=0]="Open",l[l.Closed=1]="Closed",l))(et||{}),tt=(l=>(l[l.Single=0]="Single",l[l.Multi=1]="Multi",l))(tt||{}),lt=(l=>(l[l.Pointer=0]="Pointer",l[l.Focus=1]="Focus",l[l.Other=2]="Other",l))(lt||{});let he=Symbol("ComboboxContext");function K(l){let r=ve(he,null);if(r===null){let e=new Error(`<${l} /> is missing a parent <Combobox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(e,K),e}return r}let me=Symbol("VirtualContext"),nt=U({name:"VirtualProvider",setup(l,{slots:r}){let e=K("VirtualProvider"),o=x(()=>{let n=S(e.optionsRef);if(!n)return{start:0,end:0};let v=window.getComputedStyle(n);return{start:parseFloat(v.paddingBlockStart||v.paddingTop),end:parseFloat(v.paddingBlockEnd||v.paddingBottom)}}),t=qe(x(()=>({scrollPaddingStart:o.value.start,scrollPaddingEnd:o.value.end,count:e.virtual.value.options.length,estimateSize(){return 40},getScrollElement(){return S(e.optionsRef)},overscan:12}))),a=x(()=>{var n;return(n=e.virtual.value)==null?void 0:n.options}),i=D(0);return j([a],()=>{i.value+=1}),ce(me,e.virtual.value?t:null),()=>[G("div",{style:{position:"relative",width:"100%",height:`${t.value.getTotalSize()}px`},ref:n=>{if(n){if(typeof process<"u"&&Ze.JEST_WORKER_ID!==void 0||e.activationTrigger.value===0)return;e.activeOptionIndex.value!==null&&e.virtual.value.options.length>e.activeOptionIndex.value&&t.value.scrollToIndex(e.activeOptionIndex.value)}}},t.value.getVirtualItems().map(n=>we(r.default({option:e.virtual.value.options[n.index],open:e.comboboxState.value===0})[0],{key:`${i.value}-${n.index}`,"data-index":n.index,"aria-setsize":e.virtual.value.options.length,"aria-posinset":n.index+1,style:{position:"absolute",top:0,left:0,transform:`translateY(${n.start}px)`,overflowAnchor:"none"}})))]}}),it=U({name:"Combobox",emits:{"update:modelValue":l=>!0},props:{as:{type:[Object,String],default:"template"},disabled:{type:[Boolean],default:!1},by:{type:[String,Function],nullable:!0,default:null},modelValue:{type:[Object,String,Number,Boolean],default:void 0},defaultValue:{type:[Object,String,Number,Boolean],default:void 0},form:{type:String,optional:!0},name:{type:String,optional:!0},nullable:{type:Boolean,default:!1},multiple:{type:[Boolean],default:!1},immediate:{type:[Boolean],default:!1},virtual:{type:Object,default:null}},inheritAttrs:!1,setup(l,{slots:r,attrs:e,emit:o}){let t=D(1),a=D(null),i=D(null),n=D(null),v=D(null),f=D({static:!1,hold:!1}),p=D([]),h=D(null),R=D(2),M=D(!1);function E(s=d=>d){let d=h.value!==null?p.value[h.value]:null,m=s(p.value.slice()),g=m.length>0&&m[0].dataRef.order.value!==null?m.sort((w,k)=>w.dataRef.order.value-k.dataRef.order.value):Me(m,w=>S(w.dataRef.domRef)),T=d?g.indexOf(d):null;return T===-1&&(T=null),{options:g,activeOptionIndex:T}}let F=x(()=>l.multiple?1:0),A=x(()=>l.nullable),[P,b]=De(x(()=>l.modelValue),s=>o("update:modelValue",s),x(()=>l.defaultValue)),C=x(()=>P.value===void 0?L(F.value,{1:[],0:void 0}):P.value),V=null,c=null;function I(s){return L(F.value,{0(){return b==null?void 0:b(s)},1:()=>{let d=_(u.value.value).slice(),m=_(s),g=d.findIndex(T=>u.compare(m,_(T)));return g===-1?d.push(m):d.splice(g,1),b==null?void 0:b(d)}})}let y=x(()=>{});j([y],([s],[d])=>{if(u.virtual.value&&s&&d&&h.value!==null){let m=s.indexOf(d[h.value]);m!==-1?h.value=m:h.value=null}});let u={comboboxState:t,value:C,mode:F,compare(s,d){if(typeof l.by=="string"){let m=l.by;return(s==null?void 0:s[m])===(d==null?void 0:d[m])}return l.by===null?Qe(s,d):l.by(s,d)},calculateIndex(s){return u.virtual.value?l.by===null?u.virtual.value.options.indexOf(s):u.virtual.value.options.findIndex(d=>u.compare(d,s)):p.value.findIndex(d=>u.compare(d.dataRef.value,s))},defaultValue:x(()=>l.defaultValue),nullable:A,immediate:x(()=>!1),virtual:x(()=>null),inputRef:i,labelRef:a,buttonRef:n,optionsRef:v,disabled:x(()=>l.disabled),options:p,change(s){b(s)},activeOptionIndex:x(()=>{if(M.value&&h.value===null&&(u.virtual.value?u.virtual.value.options.length>0:p.value.length>0)){if(u.virtual.value){let d=u.virtual.value.options.findIndex(m=>{var g;return!((g=u.virtual.value)!=null&&g.disabled(m))});if(d!==-1)return d}let s=p.value.findIndex(d=>!d.dataRef.disabled);if(s!==-1)return s}return h.value}),activationTrigger:R,optionsPropsRef:f,closeCombobox(){M.value=!1,!l.disabled&&t.value!==1&&(t.value=1,h.value=null)},openCombobox(){if(M.value=!0,!l.disabled&&t.value!==0){if(u.value.value){let s=u.calculateIndex(u.value.value);s!==-1&&(h.value=s)}t.value=0}},setActivationTrigger(s){R.value=s},goToOption(s,d,m){M.value=!1,V!==null&&cancelAnimationFrame(V),V=requestAnimationFrame(()=>{if(l.disabled||v.value&&!f.value.static&&t.value===1)return;if(u.virtual.value){h.value=s===z.Specific?d:re({focus:s},{resolveItems:()=>u.virtual.value.options,resolveActiveIndex:()=>{var w,k;return(k=(w=u.activeOptionIndex.value)!=null?w:u.virtual.value.options.findIndex(N=>{var H;return!((H=u.virtual.value)!=null&&H.disabled(N))}))!=null?k:null},resolveDisabled:w=>u.virtual.value.disabled(w),resolveId(){throw new Error("Function not implemented.")}}),R.value=m??2;return}let g=E();if(g.activeOptionIndex===null){let w=g.options.findIndex(k=>!k.dataRef.disabled);w!==-1&&(g.activeOptionIndex=w)}let T=s===z.Specific?d:re({focus:s},{resolveItems:()=>g.options,resolveActiveIndex:()=>g.activeOptionIndex,resolveId:w=>w.id,resolveDisabled:w=>w.dataRef.disabled});h.value=T,R.value=m??2,p.value=g.options})},selectOption(s){let d=p.value.find(g=>g.id===s);if(!d)return;let{dataRef:m}=d;I(m.value)},selectActiveOption(){if(u.activeOptionIndex.value!==null){if(u.virtual.value)I(u.virtual.value.options[u.activeOptionIndex.value]);else{let{dataRef:s}=p.value[u.activeOptionIndex.value];I(s.value)}u.goToOption(z.Specific,u.activeOptionIndex.value)}},registerOption(s,d){let m=Oe({id:s,dataRef:d});if(u.virtual.value){p.value.push(m);return}c&&cancelAnimationFrame(c);let g=E(T=>(T.push(m),T));h.value===null&&u.isSelected(d.value.value)&&(g.activeOptionIndex=g.options.indexOf(m)),p.value=g.options,h.value=g.activeOptionIndex,R.value=2,g.options.some(T=>!S(T.dataRef.domRef))&&(c=requestAnimationFrame(()=>{let T=E();p.value=T.options,h.value=T.activeOptionIndex}))},unregisterOption(s,d){if(V!==null&&cancelAnimationFrame(V),d&&(M.value=!0),u.virtual.value){p.value=p.value.filter(g=>g.id!==s);return}let m=E(g=>{let T=g.findIndex(w=>w.id===s);return T!==-1&&g.splice(T,1),g});p.value=m.options,h.value=m.activeOptionIndex,R.value=2},isSelected(s){return L(F.value,{0:()=>u.compare(_(u.value.value),_(s)),1:()=>_(u.value.value).some(d=>u.compare(_(d),_(s)))})},isActive(s){return h.value===u.calculateIndex(s)}};Se([i,n,v],()=>u.closeCombobox(),x(()=>t.value===0)),ce(he,u),Ie(x(()=>L(t.value,{0:X.Open,1:X.Closed})));let O=x(()=>{var s;return(s=S(i))==null?void 0:s.closest("form")});return le(()=>{j([O],()=>{if(!O.value||l.defaultValue===void 0)return;function s(){u.change(l.defaultValue)}return O.value.addEventListener("reset",s),()=>{var d;(d=O.value)==null||d.removeEventListener("reset",s)}},{immediate:!0})}),()=>{var s,d,m;let{name:g,disabled:T,form:w,...k}=l,N={open:t.value===0,disabled:T,activeIndex:u.activeOptionIndex.value,activeOption:u.activeOptionIndex.value===null?null:u.virtual.value?u.virtual.value.options[(s=u.activeOptionIndex.value)!=null?s:0]:(m=(d=u.options.value[u.activeOptionIndex.value])==null?void 0:d.dataRef.value)!=null?m:null,value:C.value};return G(Ce,[...g!=null&&C.value!=null?Fe({[g]:C.value}).map(([H,be])=>G(ye,Re({features:Ee.Hidden,key:H,as:"input",type:"hidden",hidden:!0,readOnly:!0,form:w,disabled:T,name:H,value:be}))):[],Y({theirProps:{...e,...ne(k,["by","defaultValue","immediate","modelValue","multiple","nullable","onUpdate:modelValue","virtual"])},ourProps:{},slot:N,slots:r,attrs:e,name:"Combobox"})])}}}),st=U({name:"ComboboxButton",props:{as:{type:[Object,String],default:"button"},id:{type:String,default:null}},setup(l,{attrs:r,slots:e,expose:o}){var t;let a=(t=l.id)!=null?t:`headlessui-combobox-button-${Q()}`,i=K("ComboboxButton");o({el:i.buttonRef,$el:i.buttonRef});function n(p){i.disabled.value||(i.comboboxState.value===0?i.closeCombobox():(p.preventDefault(),i.openCombobox()),B(()=>{var h;return(h=S(i.inputRef))==null?void 0:h.focus({preventScroll:!0})}))}function v(p){switch(p.key){case $.ArrowDown:p.preventDefault(),p.stopPropagation(),i.comboboxState.value===1&&i.openCombobox(),B(()=>{var h;return(h=i.inputRef.value)==null?void 0:h.focus({preventScroll:!0})});return;case $.ArrowUp:p.preventDefault(),p.stopPropagation(),i.comboboxState.value===1&&(i.openCombobox(),B(()=>{i.value.value||i.goToOption(z.Last)})),B(()=>{var h;return(h=i.inputRef.value)==null?void 0:h.focus({preventScroll:!0})});return;case $.Escape:if(i.comboboxState.value!==0)return;p.preventDefault(),i.optionsRef.value&&!i.optionsPropsRef.value.static&&p.stopPropagation(),i.closeCombobox(),B(()=>{var h;return(h=i.inputRef.value)==null?void 0:h.focus({preventScroll:!0})});return}}let f=ze(x(()=>({as:l.as,type:r.type})),i.buttonRef);return()=>{var p,h;let R={open:i.comboboxState.value===0,disabled:i.disabled.value,value:i.value.value},{...M}=l,E={ref:i.buttonRef,id:a,type:f.value,tabindex:"-1","aria-haspopup":"listbox","aria-controls":(p=S(i.optionsRef))==null?void 0:p.id,"aria-expanded":i.comboboxState.value===0,"aria-labelledby":i.labelRef.value?[(h=S(i.labelRef))==null?void 0:h.id,a].join(" "):void 0,disabled:i.disabled.value===!0?!0:void 0,onKeydown:v,onClick:n};return Y({ourProps:E,theirProps:M,slot:R,attrs:r,slots:e,name:"ComboboxButton"})}}}),rt=U({name:"ComboboxInput",props:{as:{type:[Object,String],default:"input"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},displayValue:{type:Function},defaultValue:{type:String,default:void 0},id:{type:String,default:null}},emits:{change:l=>!0},setup(l,{emit:r,attrs:e,slots:o,expose:t}){var a;let i=(a=l.id)!=null?a:`headlessui-combobox-input-${Q()}`,n=K("ComboboxInput"),v=x(()=>de(S(n.inputRef))),f={value:!1};t({el:n.inputRef,$el:n.inputRef});function p(){n.change(null);let c=S(n.optionsRef);c&&(c.scrollTop=0),n.goToOption(z.Nothing)}let h=x(()=>{var c;let I=n.value.value;return S(n.inputRef)?typeof l.displayValue<"u"&&I!==void 0?(c=l.displayValue(I))!=null?c:"":typeof I=="string"?I:"":""});le(()=>{j([h,n.comboboxState,v],([c,I],[y,u])=>{if(f.value)return;let O=S(n.inputRef);O&&((u===0&&I===1||c!==y)&&(O.value=c),requestAnimationFrame(()=>{var s;if(f.value||!O||((s=v.value)==null?void 0:s.activeElement)!==O)return;let{selectionStart:d,selectionEnd:m}=O;Math.abs((m??0)-(d??0))===0&&d===0&&O.setSelectionRange(O.value.length,O.value.length)}))},{immediate:!0}),j([n.comboboxState],([c],[I])=>{if(c===0&&I===1){if(f.value)return;let y=S(n.inputRef);if(!y)return;let u=y.value,{selectionStart:O,selectionEnd:s,selectionDirection:d}=y;y.value="",y.value=u,d!==null?y.setSelectionRange(O,s,d):y.setSelectionRange(O,s)}})});let R=D(!1);function M(){R.value=!0}function E(){te().nextFrame(()=>{R.value=!1})}let F=Ye();function A(c){switch(f.value=!0,F(()=>{f.value=!1}),c.key){case $.Enter:if(f.value=!1,n.comboboxState.value!==0||R.value)return;if(c.preventDefault(),c.stopPropagation(),n.activeOptionIndex.value===null){n.closeCombobox();return}n.selectActiveOption(),n.mode.value===0&&n.closeCombobox();break;case $.ArrowDown:return f.value=!1,c.preventDefault(),c.stopPropagation(),L(n.comboboxState.value,{0:()=>n.goToOption(z.Next),1:()=>n.openCombobox()});case $.ArrowUp:return f.value=!1,c.preventDefault(),c.stopPropagation(),L(n.comboboxState.value,{0:()=>n.goToOption(z.Previous),1:()=>{n.openCombobox(),B(()=>{n.value.value||n.goToOption(z.Last)})}});case $.Home:if(c.shiftKey)break;return f.value=!1,c.preventDefault(),c.stopPropagation(),n.goToOption(z.First);case $.PageUp:return f.value=!1,c.preventDefault(),c.stopPropagation(),n.goToOption(z.First);case $.End:if(c.shiftKey)break;return f.value=!1,c.preventDefault(),c.stopPropagation(),n.goToOption(z.Last);case $.PageDown:return f.value=!1,c.preventDefault(),c.stopPropagation(),n.goToOption(z.Last);case $.Escape:if(f.value=!1,n.comboboxState.value!==0)return;c.preventDefault(),n.optionsRef.value&&!n.optionsPropsRef.value.static&&c.stopPropagation(),n.nullable.value&&n.mode.value===0&&n.value.value===null&&p(),n.closeCombobox();break;case $.Tab:if(f.value=!1,n.comboboxState.value!==0)return;n.mode.value===0&&n.activationTrigger.value!==1&&n.selectActiveOption(),n.closeCombobox();break}}function P(c){r("change",c),n.nullable.value&&n.mode.value===0&&c.target.value===""&&p(),n.openCombobox()}function b(c){var I,y,u;let O=(I=c.relatedTarget)!=null?I:ae.find(s=>s!==c.currentTarget);if(f.value=!1,!((y=S(n.optionsRef))!=null&&y.contains(O))&&!((u=S(n.buttonRef))!=null&&u.contains(O))&&n.comboboxState.value===0)return c.preventDefault(),n.mode.value===0&&(n.nullable.value&&n.value.value===null?p():n.activationTrigger.value!==1&&n.selectActiveOption()),n.closeCombobox()}function C(c){var I,y,u;let O=(I=c.relatedTarget)!=null?I:ae.find(s=>s!==c.currentTarget);(y=S(n.buttonRef))!=null&&y.contains(O)||(u=S(n.optionsRef))!=null&&u.contains(O)||n.disabled.value||n.immediate.value&&n.comboboxState.value!==0&&(n.openCombobox(),te().nextFrame(()=>{n.setActivationTrigger(1)}))}let V=x(()=>{var c,I,y,u;return(u=(y=(I=l.defaultValue)!=null?I:n.defaultValue.value!==void 0?(c=l.displayValue)==null?void 0:c.call(l,n.defaultValue.value):null)!=null?y:n.defaultValue.value)!=null?u:""});return()=>{var c,I,y,u,O,s,d;let m={open:n.comboboxState.value===0},{displayValue:g,onChange:T,...w}=l,k={"aria-controls":(c=n.optionsRef.value)==null?void 0:c.id,"aria-expanded":n.comboboxState.value===0,"aria-activedescendant":n.activeOptionIndex.value===null?void 0:n.virtual.value?(I=n.options.value.find(N=>!n.virtual.value.disabled(N.dataRef.value)&&n.compare(N.dataRef.value,n.virtual.value.options[n.activeOptionIndex.value])))==null?void 0:I.id:(y=n.options.value[n.activeOptionIndex.value])==null?void 0:y.id,"aria-labelledby":(s=(u=S(n.labelRef))==null?void 0:u.id)!=null?s:(O=S(n.buttonRef))==null?void 0:O.id,"aria-autocomplete":"list",id:i,onCompositionstart:M,onCompositionend:E,onKeydown:A,onInput:P,onFocus:C,onBlur:b,role:"combobox",type:(d=e.type)!=null?d:"text",tabIndex:0,ref:n.inputRef,defaultValue:V.value,disabled:n.disabled.value===!0?!0:void 0};return Y({ourProps:k,theirProps:w,slot:m,attrs:e,slots:o,features:Z.RenderStrategy|Z.Static,name:"ComboboxInput"})}}}),ut=U({name:"ComboboxOptions",props:{as:{type:[Object,String],default:"ul"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},hold:{type:[Boolean],default:!1}},setup(l,{attrs:r,slots:e,expose:o}){let t=K("ComboboxOptions"),a=`headlessui-combobox-options-${Q()}`;o({el:t.optionsRef,$el:t.optionsRef}),W(()=>{t.optionsPropsRef.value.static=l.static}),W(()=>{t.optionsPropsRef.value.hold=l.hold});let i=Te(),n=x(()=>i!==null?(i.value&X.Open)===X.Open:t.comboboxState.value===0);Xe({container:x(()=>S(t.optionsRef)),enabled:x(()=>t.comboboxState.value===0),accept(f){return f.getAttribute("role")==="option"?NodeFilter.FILTER_REJECT:f.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(f){f.setAttribute("role","none")}});function v(f){f.preventDefault()}return()=>{var f,p,h;let R={open:t.comboboxState.value===0},M={"aria-labelledby":(h=(f=S(t.labelRef))==null?void 0:f.id)!=null?h:(p=S(t.buttonRef))==null?void 0:p.id,id:a,ref:t.optionsRef,role:"listbox","aria-multiselectable":t.mode.value===1?!0:void 0,onMousedown:v},E=ne(l,["hold"]);return Y({ourProps:M,theirProps:E,slot:R,attrs:r,slots:t.virtual.value&&t.comboboxState.value===0?{...e,default:()=>[G(nt,{},e.default)]}:e,features:Z.RenderStrategy|Z.Static,visible:n.value,name:"ComboboxOptions"})}}}),dt=U({name:"ComboboxOption",props:{as:{type:[Object,String],default:"li"},value:{type:[Object,String,Number,Boolean]},disabled:{type:Boolean,default:!1},order:{type:[Number],default:null}},setup(l,{slots:r,attrs:e,expose:o}){let t=K("ComboboxOption"),a=`headlessui-combobox-option-${Q()}`,i=D(null),n=x(()=>l.disabled);o({el:i,$el:i});let v=x(()=>{var b;return t.virtual.value?t.activeOptionIndex.value===t.calculateIndex(l.value):t.activeOptionIndex.value===null?!1:((b=t.options.value[t.activeOptionIndex.value])==null?void 0:b.id)===a}),f=x(()=>t.isSelected(l.value)),p=ve(me,null),h=x(()=>({disabled:l.disabled,value:l.value,domRef:i,order:x(()=>l.order)}));le(()=>t.registerOption(a,h)),ue(()=>t.unregisterOption(a,v.value)),W(()=>{let b=S(i);b&&(p==null||p.value.measureElement(b))}),W(()=>{t.comboboxState.value===0&&v.value&&(t.virtual.value||t.activationTrigger.value!==0&&B(()=>{var b,C;return(C=(b=S(i))==null?void 0:b.scrollIntoView)==null?void 0:C.call(b,{block:"nearest"})}))});function R(b){b.preventDefault(),b.button===pe.Left&&(n.value||(t.selectOption(a),Pe()||requestAnimationFrame(()=>{var C;return(C=S(t.inputRef))==null?void 0:C.focus({preventScroll:!0})}),t.mode.value===0&&t.closeCombobox()))}function M(){var b;if(l.disabled||(b=t.virtual.value)!=null&&b.disabled(l.value))return t.goToOption(z.Nothing);let C=t.calculateIndex(l.value);t.goToOption(z.Specific,C)}let E=Je();function F(b){E.update(b)}function A(b){var C;if(!E.wasMoved(b)||l.disabled||(C=t.virtual.value)!=null&&C.disabled(l.value)||v.value)return;let V=t.calculateIndex(l.value);t.goToOption(z.Specific,V,0)}function P(b){var C;E.wasMoved(b)&&(l.disabled||(C=t.virtual.value)!=null&&C.disabled(l.value)||v.value&&(t.optionsPropsRef.value.hold||t.goToOption(z.Nothing)))}return()=>{let{disabled:b}=l,C={active:v.value,selected:f.value,disabled:b},V={id:a,ref:i,role:"option",tabIndex:b===!0?void 0:-1,"aria-disabled":b===!0?!0:void 0,"aria-selected":f.value,disabled:void 0,onMousedown:R,onFocus:M,onPointerenter:F,onMouseenter:F,onPointermove:A,onMousemove:A,onPointerleave:P,onMouseleave:P},c=ne(l,["order","value"]);return Y({ourProps:V,theirProps:c,slot:C,attrs:e,slots:r,name:"ComboboxOption"})}}});export{Je as a,z as c,re as f,rt as i,it as l,st as n,dt as r,ut as u};
